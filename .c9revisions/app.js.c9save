{"ts":1359495816670,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"\nvar express = require('express'),\n  user = require('./routes/user'),\n  restaurant = require('./routes/restaurant'),\n  http = require('http'),\n  path = require('path'),\n  config = require('./config'),\n  auth = require('./auth'),\n  stylus = require('stylus'),\n  url = require('url');\n\nvar app = express();\n\nvar db = require('./db');\nvar User = db.User;\n\nvar RedisStore = require('connect-redis')(express);\n\napp.configure(function(){\n  var redisUrl = url.parse(process.env.REDISTOGO_URL);\n    //redisAuth = redisUrl.auth.split(':');\n  app.set('redisHost', redisUrl.hostname);\n  app.set('redisPort', redisUrl.port);\n  //app.set('redisDb', redisAuth[0]);\n  //app.set('redisPass', redisAuth[1]);\n});\n\napp.configure(function(){\n  app.set('port', process.env.PORT || 3000);\n  app.set('views', __dirname + '/views');\n  app.set('view engine', 'jade');\n  app.use(stylus.middleware({\n    src: \"\" + __dirname + \"/views\",\n    dest: \"\" + __dirname + \"/public\",\n    compress: true\n  }));\n  app.use(express.favicon());\n  app.use(express.logger('dev'));\n  app.use(express.bodyParser());\n  app.use(express.methodOverride());\n  app.use(express.cookieParser('my super sekret hash'));\n  app.use(express.session({\n    secret: 'my super sekret hash',\n    store: new RedisStore({\n      host: app.get('redisHost'),\n      port: app.get('redisPort')\n      //db: app.get('redisDb'),\n      //pass: app.get('redisPass')\n    })\n  }));\n  app.use(app.router);\n  app.use(express.static(path.join(__dirname, 'public')));\n});\n\napp.configure('development', function(){\n  app.use(express.errorHandler());\n});\n\nvar routes = require('./routes');\n\napp.get('/', auth.cookieCheck, routes.index);\napp.get('/restaurants', restaurant.list);\napp.post('/restaurants', restaurant.create);\napp.get('/user/checkin', user.list);\napp.post('/user/checkin', user.checkin);\napp.post('/user/login', user.login);\n\nhttp.createServer(app).listen(app.get('port'), function(){\n  console.log(\"Express server listening on port \" + app.get('port'));\n});\n"]],"start1":0,"start2":0,"length1":0,"length2":1989}]],"length":1989}
{"contributors":[],"silentsave":false,"ts":1359496069829,"patch":[[{"diffs":[[0,"URL)"],[-1,";"],[1,","],[0,"\n    "],[-1,"//"],[0,"redi"]],"start1":481,"start2":481,"length1":16,"length2":14},{"diffs":[[0,"rl.port);\n  "],[-1,"//"],[0,"app.set('red"]],"start1":601,"start2":601,"length1":26,"length2":24},{"diffs":[[0,"[0]);\n  "],[-1,"//"],[0,"app.set("]],"start1":641,"start2":641,"length1":18,"length2":16},{"diffs":[[0,"isPort')"],[1,","],[0,"\n      "],[-1,"//"],[0,"db: app."]],"start1":1308,"start2":1308,"length1":25,"length2":24},{"diffs":[[0,"    "],[-1,"//"],[0,"pass"]],"start1":1350,"start2":1350,"length1":10,"length2":8}]],"length":1980,"saved":false}
